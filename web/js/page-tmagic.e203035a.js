"use strict";(self["webpackChunkonline_conplier"]=self["webpackChunkonline_conplier"]||[]).push([[1830],{1350:function(e,t,o){o(27515)},64172:function(e,t,o){o.r(t),o.d(t,{default:function(){return d}});o(1350);var n=o(10252),a=o(10311),r=o(72748),i=o(32202),l=o(529),s=o(29583),u=o(10525),p=o(15941);const c={class:"container"};var v={__name:"tmagic",setup(e){const t=(0,a.ref)(),o=(0,a.ref)({left:[],center:["delete","undo","redo","zoom-in","zoom-out"],right:[{type:"button",text:"保存",icon:r.qWi,handler:()=>{n.ZP.info("功能还在开发中")}},{type:"button",icon:r.BBB,text:"源码",handler:e=>e?.uiService.set("showSrc",!e?.uiService.get("showSrc"))}]}),v=(0,a.ref)({type:"app",id:"app_1",items:[]}),m=`${location.pathname}#/runtime`,d=(0,a.ref)({"van-row":[{text:"间隔",name:"gutter"}],"van-col":[{type:"select",text:"占比",name:"span",options:[{text:"24",value:24},{text:"16",value:16},{text:"12",value:12},{text:"8",value:8},{text:"6",value:6},{text:"4",value:4},{text:"3",value:3},{text:"2",value:2},{text:"1",value:1}]}],"van-image":[{name:"width",text:"宽度"},{name:"height",text:"高度"},{name:"src",text:"图片地址"}]}),g=(0,a.ref)({}),f=(0,a.ref)([{title:"容器",items:[{icon:r.JZA,text:"Row",type:"van-row"},{icon:r.JZA,text:"Col",type:"van-col"}]},{title:"基础组件",items:[{icon:r.NuB,text:"图片",type:"van-image"}]}]),x=e=>{const o={},n=e?.dr?.target?.id;if(!n||!t.value)return o;const a=t.value.editorService.getNodeById(n);if(!a)return o;const r=a.type===i.J.PAGE;return o.draggable=!r,o.resizable=!r,o};return(0,a.onMounted)((async()=>{const e=await(0,s.findComponents)();f.value.push({title:"自定义组件",items:e.map((e=>{const{script:t,code:o,propsConfigs:n,initValues:a,eventConfigs:i,createTime:s,updateTime:u,type:c,...v}=e;let m={};l.propsService.setPropsValues(e.type,m);let d=[];try{d=JSON.parse(n),d.map((e=>{m[e.name]=e.value}))}catch(g){p.log("解析propsConfigs出错"),p.log(g)}return l.propsService.setPropsConfig(e.type,d),{icon:r.NuB,text:e.name,type:e.type}}))}),p.log(d.value);const t=await(0,u.fX)(),o=t.map((e=>{const{protocl:t,...o}=e;return{...o,items:JSON.parse(t).items}}));p.log(v.value),v.value.items.push(...o),p.log(l.editorService.set("root",v.value)),l.editorService.set("page",v.value.items[0]),l.editorService.set("parent",v.value.items[0]),l.propsService.getPropsConfig("van-image").then((e=>{p.log(e)}))})),(e,n)=>{const r=(0,a.resolveComponent)("m-editor");return(0,a.openBlock)(),(0,a.createElementBlock)("div",c,[(0,a.createVNode)(r,{ref_key:"editor",ref:t,modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=e=>v.value=e),menu:o.value,"runtime-url":m,"props-configs":d.value,"props-values":g.value,"component-group-list":f.value,"moveable-options":x},null,8,["modelValue","menu","props-configs","props-values","component-group-list"])])}}};const m=v;var d=m}}]);