"use strict";(self["webpackChunkonline_conplier"]=self["webpackChunkonline_conplier"]||[]).push([[13],{3013:function(e,t,n){n.r(t),n.d(t,{DEFAULT_EVENTS:function(){return c},DEFAULT_METHODS:function(){return h},bindCommonEventListener:function(){return p},default:function(){return w},getCommonEventName:function(){return f},isCommonMethod:function(){return u},triggerCommonMethod:function(){return v}});n(6699),n(1703);var i=n(3793);class s{constructor(e=globalThis.navigator.userAgent,t={}){this.isIos=!1,this.isIphone=!1,this.isIpad=!1,this.isAndroid=!1,this.isAndroidPad=!1,this.isMac=!1,this.isWin=!1,this.isMqq=!1,this.isWechat=!1,this.isWeb=!1,this.isIphone=e.indexOf("iPhone")>=0,this.isIpad=/(iPad).*OS\s([\d_]+)/.test(e),this.isIos=this.isIphone||this.isIpad,this.isAndroid=e.indexOf("Android")>=0,this.isAndroidPad=this.isAndroid&&e.indexOf("Mobile")<0,this.isMac=e.indexOf("Macintosh")>=0,this.isWin=e.indexOf("Windows")>=0,this.isMqq=/QQ\/([\d.]+)/.test(e),this.isWechat=e.indexOf("MicroMessenger")>=0&&e.indexOf("wxwork")<0,this.isWeb=!this.isIos&&!this.isAndroid&&!/(WebOS|BlackBerry)/.test(e),Object.entries(t).forEach((([e,t])=>{this[e]=t}))}}const r="magic:common:events:",o="magic:common:actions:",a={SHOW:"show",HIDE:"hide",SCROLL_TO_VIEW:"scrollIntoView",SCROLL_TO_TOP:"scrollToTop"},c=[{label:"点击",value:`${r}click`}],h=[],f=(e,t)=>{const n=`${e}:${t}`;return e.startsWith(r)?n:`${r}${n}`},u=e=>e.startsWith(o),l=(e,t)=>{if(!e)return!1;if(!e.id)return l(e.parentElement,t);const n=t.page?.getNode(e.id);return n||!1},d=(e,t,n)=>{const i=l(n.target,e);if(i){const{instance:n,data:s}=i;e.emit(f(t,s.id),n)}},p=e=>{window.document.body.addEventListener("click",(t=>{d(e,"click",t)})),window.document.body.addEventListener("click",(t=>{d(e,"click:capture",t)}),!0)},v=(e,t)=>{const{instance:n}=t;switch(e.replace(o,"")){case a.SHOW:n.show();break;case a.HIDE:n.hide();break;case a.SCROLL_TO_VIEW:n.$el.scrollIntoView({behavior:"smooth"});break;case a.SCROLL_TO_TOP:window.scrollTo({top:0,behavior:"smooth"});break}};class m extends i.EventEmitter{constructor(e){super();const{events:t}=e;this.data=e,this.events=t,this.listenLifeSafe(),this.once("destroy",(()=>{this.instance=null,"function"===typeof this.data.destroy&&this.data.destroy(this),this.listenLifeSafe()}))}listenLifeSafe(){this.once("created",(e=>{this.instance=e,"function"===typeof this.data.created&&this.data.created(this)})),this.once("mounted",(e=>{this.instance=e,"function"===typeof this.data.mounted&&this.data.mounted(this)}))}}class g extends m{constructor(e){super(e.config),this.nodes=new Map,this.setNode(e.config.id,this),this.initNode(e.config)}initNode(e){this.setNode(e.id,new m(e)),e.items?.forEach((e=>{this.initNode(e)}))}getNode(e){return this.nodes.get(e)}setNode(e,t){this.nodes.set(e,t)}deleteNode(e){this.nodes.delete(e)}}const y=e=>{if("string"!==typeof e)return e;const t={};return e.split(";").forEach((e=>{if(!e)return;const n=e.split(":");let i=n.shift(),s=n.join(":");i&&(i=i.replace(/^\s*/,"").replace(/\s*$/,""),s=s.replace(/^\s*/,"").replace(/\s*$/,""),i=i.split("-").map(((e,t)=>t>0?`${e[0].toUpperCase()}${e.substr(1)}`:e)).join(""),t[i]=s)})),t},L=e=>!e||/^url/.test(e)||/^linear-gradient/.test(e)?e:`url(${e})`;class w extends i.EventEmitter{constructor(e){if(super(),this.pages=new Map,this.platform="mobile",this.jsEngine="browser",this.components=new Map,this.env=new s(e.ua),e.platform&&(this.platform=e.platform),e.jsEngine&&(this.jsEngine=e.jsEngine),"mobile"===this.platform||"editor"===this.platform){const e=()=>{let{width:e}=document.documentElement.getBoundingClientRect();e=Math.min(800,e);const t=e/3.75;document.documentElement.style.fontSize=`${t}px`};e(),document.body.style.fontSize="14px",globalThis.addEventListener("resize",e)}e.transformStyle&&(this.transformStyle=e.transformStyle),e.config&&this.setConfig(e.config,e.curPage),p(this)}transformStyle(e){if(!e)return{};let t={};const n={};t="string"===typeof e?y(e):{...e};const i=["zIndex","opacity","fontWeight"];return Object.entries(t).forEach((([e,t])=>{"backgroundImage"===e?t&&(n[e]=L(t)):"transform"===e&&"string"!==typeof t?n[e]=Object.entries(t).map((([e,t])=>{let n=0;return"scale"===e&&(n=1),`${e}(${t||n})`})).join(" "):!i.includes(e)&&t&&/^[-]?[0-9]*[.]?[0-9]*$/.test(t)?n[e]=t/100+"rem":n[e]=t})),n}setConfig(e,t){this.pages=new Map,e.items?.forEach((e=>{this.pages.set(e.id,new g({config:e}))})),this.setPage(t||this.page?.data?.id)}setPage(e){let t;e&&(t=this.pages.get(e)),t||(t=this.pages.get(this.pages.keys().next().value)),this.page=t,"magic"!==this.platform&&this.bindEvents()}registerComponent(e,t){this.components.set(e,t)}unregisterComponent(e){this.components.delete(e)}resolveComponent(e){return this.components.get(e)}bindEvents(){if(this.page){this.removeAllListeners();for(const[,e]of this.page.nodes)e.events?.forEach((t=>{let{name:n}=t;c.findIndex((e=>e.value===n))>-1&&(n=f(n,`${e.data.id}`)),this.on(n,((e,...n)=>{if(!this.page)throw new Error("当前没有页面");const i=this.page.getNode(t.to);if(!i)throw`ID为${t.to}的组件不存在`;const{method:s}=t;if(u(s))return v(s,i);"function"===typeof i.instance?.[s]&&i.instance[s](e,...n)}))}))}}destroy(){this.removeAllListeners(),this.pages.clear()}}},3793:function(e,t,n){var i=n(5941);n(1703);var s,r="object"===typeof Reflect?Reflect:null,o=r&&"function"===typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function a(e){i&&i.warn&&i.warn(e)}s=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var c=Number.isNaN||function(e){return e!==e};function h(){h.init.call(this)}e.exports=h,e.exports.once=b,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var f=10;function u(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?h.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var s,r,o;if(u(n),r=e._events,void 0===r?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),o=r[t]),void 0===o)o=r[t]=n,++e._eventsCount;else if("function"===typeof o?o=r[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),s=l(e),s>0&&o.length>s&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a(c)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=p.bind(i);return s.listener=n,i.wrapFn=s,s}function m(e,t,n){var i=e._events;if(void 0===i)return[];var s=i[t];return void 0===s?[]:"function"===typeof s?n?[s.listener||s]:[s]:n?w(s):y(s,s.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function L(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function w(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function b(e,t){return new Promise((function(n,i){function s(n){e.removeListener(t,r),i(n)}function r(){"function"===typeof e.removeListener&&e.removeListener("error",s),n([].slice.call(arguments))}_(e,t,r,{once:!0}),"error"!==t&&E(e,s,{once:!0})}))}function E(e,t,n){"function"===typeof e.on&&_(e,"error",t,n)}function _(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function s(r){i.once&&e.removeEventListener(t,s),n(r)}))}}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(e){if("number"!==typeof e||e<0||c(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");f=e}}),h.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||c(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},h.prototype.getMaxListeners=function(){return l(this)},h.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var r;if(t.length>0&&(r=t[0]),r instanceof Error)throw r;var a=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw a.context=r,a}var c=s[e];if(void 0===c)return!1;if("function"===typeof c)o(c,this,t);else{var h=c.length,f=y(c,h);for(n=0;n<h;++n)o(f[n],this,t)}return!0},h.prototype.addListener=function(e,t){return d(this,e,t,!1)},h.prototype.on=h.prototype.addListener,h.prototype.prependListener=function(e,t){return d(this,e,t,!0)},h.prototype.once=function(e,t){return u(t),this.on(e,v(this,e,t)),this},h.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,v(this,e,t)),this},h.prototype.removeListener=function(e,t){var n,i,s,r,o;if(u(t),i=this._events,void 0===i)return this;if(n=i[e],void 0===n)return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(s=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){o=n[r].listener,s=r;break}if(s<0)return this;0===s?n.shift():L(n,s),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,r=Object.keys(n);for(i=0;i<r.length;++i)s=r[i],"removeListener"!==s&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],"function"===typeof t)this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},h.prototype.listeners=function(e){return m(this,e,!0)},h.prototype.rawListeners=function(e){return m(this,e,!1)},h.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},h.prototype.listenerCount=g,h.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]}}}]);