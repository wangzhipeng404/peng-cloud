{"version":3,"file":"js/component-list.5534d3f4.js","mappings":"moBAEOA,eAAeC,EAAcC,GAChC,MAAMC,QAAcC,EAAAA,GAAAA,WAAAA,MAAoB,OAAOC,iBAAiBH,EAAYI,KAAKH,QACjF,IAAKD,EAAYK,IAAMJ,EAAQ,EAC3B,KAAM,eAEV,MAAMK,EAAU,IACTN,EACHO,WAAYP,EAAYO,aAAc,IAAIC,MAAOC,UACjDC,YAAY,IAAIF,MAAOC,WAE3BE,EAAQC,IAAIZ,GACZ,MAAMK,QAAWH,EAAAA,GAAAA,WAAAA,IAAkBI,EAASA,EAAQD,IACpD,OAAOA,CACV,CAEMP,eAAee,IAClB,MAAMC,QAAaZ,EAAAA,GAAAA,WAAAA,UAAwBa,OAAO,cAClD,OAAOD,CACV,CACMhB,eAAekB,EAAaZ,GAC/B,MAAMa,QAAmBf,EAAAA,GAAAA,WAAAA,KAAmBE,GAE5C,OADAO,EAAQC,IAAIK,GACLA,CACV,CAEMnB,eAAeoB,EAAgBd,SAC5BF,EAAAA,GAAAA,WAAAA,UAAqBE,EAC9B,C,8fCYD,MAAMe,GAASC,EAAAA,EAAAA,MACTC,GAAaC,EAAAA,EAAAA,KAAI,IACjBC,GAAeD,EAAAA,EAAAA,KAAID,EAAWG,OAC9BC,EAAW,KACfF,EAAaC,MAAQH,EAAWG,MAAME,QAAOC,GAAKA,EAAEC,KAAKC,QAAQC,EAAYF,OAAS,GAAKD,EAAEvB,IAAIyB,QAAQC,EAAY1B,KAAO,GAA5H,EAEI2B,EAAU,KACdD,EAAYF,KAAO,GACnBE,EAAY1B,IAAM,GAClBmB,EAAaC,MAAQH,EAAWG,KAAhC,EAEIQ,EAAUlC,UACd,MAAMmC,QAAYpB,EAAAA,EAAAA,kBAClBQ,EAAWG,MAAQS,EAAIC,KAAIC,IAChB,IACFA,EACH5B,WAAY6B,KAAOD,EAAI5B,YAAY8B,OAAO,uBAC1C3B,WAAY0B,KAAOD,EAAIzB,YAAY2B,OAAO,2BAG9CZ,GAAU,EAERa,EAAQ,IAAMnB,EAAOoB,KAAK,CAAEX,KAAM,WAClCY,EAAW1C,MAAOO,EAAID,WACpBc,EAAAA,EAAAA,gBAAeb,GACrB2B,KACAS,EAAAA,EAAAA,kBAAiBrC,GACjBsC,EAAA,WAAgB,CACdC,QAAS,OACTC,SAAU,GAFZ,EAKId,GAAce,EAAAA,EAAAA,UAAS,CAC3BjB,KAAM,GACNxB,IAAK,KAGD0C,GAAUxB,EAAAA,EAAAA,KAAI,CAClB,CACEyB,MAAO,KACPC,UAAW,OACX5C,IAAK,QAEP,CACE2C,MAAO,MACPC,UAAW,MACX5C,IAAK,OAEP,CACE2C,MAAO,OACPC,UAAW,aACX5C,IAAK,cAEP,CACE2C,MAAO,SACPC,UAAW,aACX5C,IAAK,cAEP,CACE2C,MAAO,KACPC,UAAW,SACXC,aAAc,EAAGC,aACR,iBAAC,wCAAR,KAEiB,QAFjB,KAE8B,OAF9B,QAE8C,IAAM/B,EAAOoB,KAAK,CAAEX,KAAM,SAAUuB,OAAQ,CAAE9C,GAAI6C,EAAO7C,OAFvG,yEAGkB,YAHlB,mCAKY,WALZ,OAMa,KANb,WAOiB,KAPjB,UAQiB,IAAMmC,EAASU,EAAO7C,GAAI6C,EAAO9C,MARlD,0CAUmB,QAVnB,KAUgC,OAVhC,QAUgD,IAAMO,EAAQC,IAAIsC,IAVlE,qD,OAkBNE,EAAAA,EAAAA,YAAU,KACRpB,GAAS,I,o1CCrHX,MAAMqB,EAAc,EAEpB,O","sources":["webpack://online-conplier/./src/service/compoment.js","webpack://online-conplier/./src/views/component-list/index.vue","webpack://online-conplier/./src/views/component-list/index.vue?eb7f"],"sourcesContent":["import { db } from './db'\r\n\r\nexport async function saveComponent(componetObj) {\r\n    const count = await db.components.where('key').equalsIgnoreCase(componetObj.key).count()\r\n    if (!componetObj.id && count > 0) {\r\n        throw '组件key已存在，请修改'\r\n    }\r\n    const newData = { \r\n        ...componetObj,\r\n        createTime: componetObj.createTime || new Date().getTime(),\r\n        updateTime: new Date().getTime()\r\n    }\r\n    console.log(componetObj)\r\n    const id = await db.components.put(newData, newData.id)\r\n    return id\r\n}\r\n\r\nexport async function findComponents () {\r\n    const list = await db.components.reverse().sortBy('updateTime')\r\n    return list\r\n}\r\nexport async function getComponet (key) {\r\n    const component =  await db.components.get(+key)\r\n    console.log(component)\r\n    return component\r\n}\r\n\r\nexport async function deleteComponet (key) {\r\n    await db.components.delete(key)\r\n}","<!-- eslint-disable vue/multi-word-component-names -->\r\n<template>\r\n  <PageContainer>\r\n    <div class=\"filter-wrap\">\r\n      <Form layout=\"inline\" :model=\"filterState\">\r\n        <Form.Item label=\"组件名称\" name=\"name\">\r\n          <Input v-model:value=\"filterState.name\" />\r\n        </Form.Item>\r\n        <Form.Item label=\"组件key\" name=\"key\">\r\n          <Input v-model:value=\"filterState.key\" />\r\n        </Form.Item>\r\n        <Form.Item>\r\n          <Button type=\"primary\" @click=\"onSearch\">搜索</Button>\r\n        </Form.Item>\r\n        <Form.Item>\r\n          <Button @click=\"onReset\">重置</Button>\r\n        </Form.Item>\r\n      </Form>\r\n    </div>\r\n    <div class=\"operation-wrap\">\r\n      <Button type=\"primary\" @click=\"onAdd\">新增</Button>\r\n    </div>\r\n    <div class=\"table-wrap\">\r\n      <Table\r\n        class=\"table\"\r\n        :dataSource=\"filteredData\"\r\n        :columns=\"columns\"\r\n        size=\"middle\"\r\n      />\r\n    </div>\r\n  </PageContainer>\r\n</template>\r\n<script setup>\r\nimport { onMounted, reactive, ref } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { PageContainer } from '@ant-design-vue/pro-layout'\r\nimport { Table, Form, Input, Button, Divider, Popconfirm, message } from 'ant-design-vue'\r\nimport { findComponents, deleteComponet } from '../../service/compoment'\r\nimport dayjs from 'dayjs'\r\nimport { unregistComponet } from '@/utils/parser'\r\n\r\nconst router = useRouter()\r\nconst dataSource = ref([])\r\nconst filteredData = ref(dataSource.value)\r\nconst onSearch = () => {\r\n  filteredData.value = dataSource.value.filter(d => d.name.indexOf(filterState.name) > -1 && d.key.indexOf(filterState.key)  -1)\r\n}\r\nconst onReset = () => {\r\n  filterState.name = ''\r\n  filterState.key = ''\r\n  filteredData.value = dataSource.value\r\n}\r\nconst getData = async () => {\r\n  const res = await findComponents()\r\n  dataSource.value = res.map(com => {\r\n      return {\r\n        ...com,\r\n        createTime: dayjs(+com.createTime).format('YYYY-MM-DD HH:mm:ss'),\r\n        updateTime: dayjs(+com.updateTime).format('YYYY-MM-DD HH:mm:ss'),\r\n      }\r\n    })\r\n    onSearch()\r\n}\r\nconst onAdd = () => router.push({ name: 'editor' })\r\nconst onDelete = async (id, key) => {\r\n  await deleteComponet(id)\r\n  getData()\r\n  unregistComponet(key)\r\n  message.success({\r\n    content: '删除成功',\r\n    duration: 3\r\n  })\r\n}\r\nconst filterState = reactive({\r\n  name: '',\r\n  key: ''\r\n})\r\n\r\nconst columns = ref([\r\n  {\r\n    title: '名称',\r\n    dataIndex: 'name',\r\n    key: 'name',\r\n  },\r\n  {\r\n    title: 'key',\r\n    dataIndex: 'key',\r\n    key: 'key',\r\n  },\r\n  {\r\n    title: '创建时间',\r\n    dataIndex: 'createTime',\r\n    key: 'createTime',\r\n  },\r\n  {\r\n    title: '最后更新时间',\r\n    dataIndex: 'updateTime',\r\n    key: 'updateTime',\r\n  },\r\n  {\r\n    title: '操作', \r\n    dataIndex: 'action',\r\n    customRender: ({ record }) => {\r\n      return (\r\n        <>\r\n          <Button size=\"small\" type=\"link\" onClick={() => router.push({ name: 'editor', params: { id: record.id }})}>编辑</Button>\r\n          <Divider type=\"vertical\" />\r\n          <Popconfirm\r\n            title=\"确认删除此组件？\"\r\n            okText=\"确认\"\r\n            cancelText=\"取消\"\r\n            onConfirm={() => onDelete(record.id, record.key)}\r\n          >\r\n            <Button size=\"small\" type=\"link\" onClick={() => console.log(record)}>删除</Button>\r\n          </Popconfirm>\r\n        </>\r\n      )\r\n    }\r\n  }\r\n])\r\n\r\nonMounted(() => {\r\n  getData()\r\n})\r\n</script>\r\n\r\n<style lang=\"stylus\">\r\n.operation-wrap\r\n  padding 16px 0\r\n</style>","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=bc524df4&lang=stylus\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["async","saveComponent","componetObj","count","db","equalsIgnoreCase","key","id","newData","createTime","Date","getTime","updateTime","console","log","findComponents","list","sortBy","getComponet","component","deleteComponet","router","useRouter","dataSource","ref","filteredData","value","onSearch","filter","d","name","indexOf","filterState","onReset","getData","res","map","com","dayjs","format","onAdd","push","onDelete","unregistComponet","message","content","duration","reactive","columns","title","dataIndex","customRender","record","params","onMounted","__exports__"],"sourceRoot":""}