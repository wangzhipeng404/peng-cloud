{"version":3,"file":"js/lib-list.fc685804.js","mappings":"0aAiBOA,eAAeC,IAClB,MAAMC,QAAaC,EAAAA,GAAAA,KAAAA,UAAkBC,OAAO,cAC5C,OAAOF,CACV,C,4OCoBD,MAAMG,GAASC,EAAAA,EAAAA,MACTC,GAAaC,EAAAA,EAAAA,KAAI,IACjBC,GAAeD,EAAAA,EAAAA,KAAID,EAAWG,OAC9BC,EAAW,KACfF,EAAaC,MAAQH,EAAWG,MAAME,QAAOC,GAAKA,EAAEC,KAAKC,QAAQC,EAAYF,OAAS,GAAKD,EAAEI,IAAIF,QAAQC,EAAYC,KAAO,GAA5H,EAEIC,EAAU,IAAMT,EAAaC,MAAQH,EAAWG,MAChDS,EAAUnB,UACd,MAAMoB,QAAYnB,IAClBM,EAAWG,MAAQU,EAAIC,KAAIC,IAChB,IACFA,EACHC,WAAYC,KAAOF,EAAIC,YAAYE,OAAO,uBAC1CC,WAAYF,KAAOF,EAAII,YAAYD,OAAO,2BAG9Cd,GAAU,EAERgB,EAAQ,IAAMtB,EAAOuB,KAAK,CAAEd,KAAM,WAClCe,EAAW7B,gBACT8B,EAAAA,EAAAA,WAAUC,GAChBZ,IACAa,EAAA,WAAgB,CACdC,QAAS,OACTC,SAAU,GAFZ,EAKIlB,GAAcmB,EAAAA,EAAAA,UAAS,CAC3BrB,KAAM,GACNG,IAAK,KAGDmB,GAAU5B,EAAAA,EAAAA,KAAI,CAClB,CACE6B,MAAO,KACPC,UAAW,OACXrB,IAAK,QAEP,CACEoB,MAAO,MACPC,UAAW,MACXrB,IAAK,OAEP,CACEoB,MAAO,OACPC,UAAW,aACXrB,IAAK,cAEP,CACEoB,MAAO,SACPC,UAAW,aACXrB,IAAK,cAEP,CACEoB,MAAO,KACPC,UAAW,SACXC,aAAc,EAAGC,aACR,iBAAC,wCAAR,KAEiB,QAFjB,KAE8B,OAF9B,QAE8C,IAAMnC,EAAOuB,KAAK,CAAEd,KAAM,SAAU2B,OAAQ,CAAEV,GAAIS,EAAOT,OAFvG,yEAGkB,YAHlB,mCAKY,WALZ,OAMa,KANb,WAOiB,KAPjB,UAQiB,IAAMF,EAASW,EAAOT,KARvC,0CAUmB,QAVnB,KAUgC,OAVhC,QAUgD,IAAMW,EAAQC,IAAIH,IAVlE,qD,OAkBNI,EAAAA,EAAAA,YAAU,KACRzB,GAAS,I,u0CC/GX,MAAM0B,EAAc,EAEpB,O","sources":["webpack://online-conplier/./src/service/lib.js","webpack://online-conplier/./src/views/lib-list/index.vue","webpack://online-conplier/./src/views/lib-list/index.vue?3e47"],"sourcesContent":["import { db } from './db'\r\n\r\nexport async function saveLib(libObj) {\r\n    const count = await db.libs.where('key').equalsIgnoreCase(libObj.key).count()\r\n    if (!libObj.id && count > 0) {\r\n        throw 'key已存在，请修改'\r\n    }\r\n    const newData = { \r\n        ...libObj,\r\n        createTime: libObj.createTime || new Date().getTime(),\r\n        updateTime: new Date().getTime()\r\n    }\r\n    console.log(libObj)\r\n    const id = await db.libs.put(newData, newData.id)\r\n    return id\r\n}\r\n\r\nexport async function findLibs () {\r\n    const list = await db.libs.reverse().sortBy('updateTime')\r\n    return list\r\n}\r\nexport async function getLib (key) {\r\n    const lib =  await db.libs.get(+key)\r\n    console.log(lib)\r\n    return lib\r\n}\r\n\r\nexport async function deletelib (key) {\r\n    await db.libs.delete(key)\r\n}","<!-- eslint-disable vue/multi-word-component-names -->\r\n<template>\r\n  <PageContainer>\r\n    <div class=\"filter-wrap\">\r\n      <Form layout=\"inline\" :model=\"filterState\">\r\n        <Form.Item label=\"库名称\" name=\"name\">\r\n          <Input v-model:value=\"filterState.name\" />\r\n        </Form.Item>\r\n        <Form.Item label=\"库key\" name=\"key\">\r\n          <Input v-model:value=\"filterState.key\" />\r\n        </Form.Item>\r\n        <Form.Item>\r\n          <Button type=\"primary\" @click=\"onSearch\">搜索</Button>\r\n        </Form.Item>\r\n        <Form.Item>\r\n          <Button @click=\"onReset\">重置</Button>\r\n        </Form.Item>\r\n      </Form>\r\n    </div>\r\n    <div class=\"operation-wrap\">\r\n      <Button type=\"primary\" @click=\"onAdd\">新增</Button>\r\n    </div>\r\n    <div class=\"table-wrap\">\r\n      <Table\r\n        class=\"table\"\r\n        :dataSource=\"filteredData\"\r\n        :columns=\"columns\"\r\n        size=\"middle\"\r\n      />\r\n    </div>\r\n  </PageContainer>\r\n</template>\r\n<script setup>\r\nimport { onMounted, reactive, ref } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { PageContainer } from '@ant-design-vue/pro-layout'\r\nimport { Table, Form, Input, Button, Divider, Popconfirm, message } from 'ant-design-vue'\r\nimport { findLibs, deleteLib } from '../../service/lib'\r\nimport dayjs from 'dayjs'\r\n\r\nconst router = useRouter()\r\nconst dataSource = ref([])\r\nconst filteredData = ref(dataSource.value)\r\nconst onSearch = () => {\r\n  filteredData.value = dataSource.value.filter(d => d.name.indexOf(filterState.name) > -1 && d.key.indexOf(filterState.key)  -1)\r\n}\r\nconst onReset = () => filteredData.value = dataSource.value\r\nconst getData = async () => {\r\n  const res = await findLibs()\r\n  dataSource.value = res.map(com => {\r\n      return {\r\n        ...com,\r\n        createTime: dayjs(+com.createTime).format('YYYY-MM-DD HH:mm:ss'),\r\n        updateTime: dayjs(+com.updateTime).format('YYYY-MM-DD HH:mm:ss'),\r\n      }\r\n    })\r\n    onSearch()\r\n}\r\nconst onAdd = () => router.push({ name: 'editor' })\r\nconst onDelete = async (id) => {\r\n  await deleteLib(id)\r\n  getData()\r\n  message.success({\r\n    content: '删除成功',\r\n    duration: 3\r\n  })\r\n}\r\nconst filterState = reactive({\r\n  name: '',\r\n  key: ''\r\n})\r\n\r\nconst columns = ref([\r\n  {\r\n    title: '名称',\r\n    dataIndex: 'name',\r\n    key: 'name',\r\n  },\r\n  {\r\n    title: 'key',\r\n    dataIndex: 'key',\r\n    key: 'key',\r\n  },\r\n  {\r\n    title: '创建时间',\r\n    dataIndex: 'createTime',\r\n    key: 'createTime',\r\n  },\r\n  {\r\n    title: '最后更新时间',\r\n    dataIndex: 'updateTime',\r\n    key: 'updateTime',\r\n  },\r\n  {\r\n    title: '操作', \r\n    dataIndex: 'action',\r\n    customRender: ({ record }) => {\r\n      return (\r\n        <>\r\n          <Button size=\"small\" type=\"link\" onClick={() => router.push({ name: 'editor', params: { id: record.id }})}>编辑</Button>\r\n          <Divider type=\"vertical\" />\r\n          <Popconfirm\r\n            title=\"确认删除此组件？\"\r\n            okText=\"确认\"\r\n            cancelText=\"取消\"\r\n            onConfirm={() => onDelete(record.id)}\r\n          >\r\n            <Button size=\"small\" type=\"link\" onClick={() => console.log(record)}>删除</Button>\r\n          </Popconfirm>\r\n        </>\r\n      )\r\n    }\r\n  }\r\n])\r\n\r\nonMounted(() => {\r\n  getData()\r\n})\r\n</script>\r\n\r\n<style lang=\"stylus\">\r\n.operation-wrap\r\n  padding 16px 0\r\n</style>","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=e3088de2&lang=stylus\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["async","findLibs","list","db","sortBy","router","useRouter","dataSource","ref","filteredData","value","onSearch","filter","d","name","indexOf","filterState","key","onReset","getData","res","map","com","createTime","dayjs","format","updateTime","onAdd","push","onDelete","deleteLib","id","message","content","duration","reactive","columns","title","dataIndex","customRender","record","params","console","log","onMounted","__exports__"],"sourceRoot":""}